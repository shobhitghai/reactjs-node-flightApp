(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Define Namespace
(function() {
   window.app = {};
}).call(this);


(function() {
    app.util = function(){
        console.log("hello")
    }
})(app);

var Dropdown = React.createClass({displayName: "Dropdown",
  getInitialState: function() {
  	this.cityList = [];

    return {
      cities : '',
      selectedCity: this.props.data.defaultText
    };
  },

  componentDidMount: function() {
  	var self = this; 
    $.ajax({
    	url: self.props.data.fetchUrl,
    	success: function(data){
    		self.setState({
    			cities: data
    		});
    	}
    });
  },

  citySelectionHandler: function(e){
  	var selectedText = $(e.target).text();
  	this.setState({
  		selectedCity: selectedText
  	});
  },

  render: function() {
  	if(!this.cityList.length){
		for(var i = 0;  i < this.state.cities.length; i++ ){
  			this.cityList.push(React.createElement("li", {key: i, onClick: this.citySelectionHandler}, React.createElement("a", {href: "javascript:void(0)"}, this.state.cities[i])));
	  	}
  	}
  	
    return (
    	React.createElement("div", {className: "dropdown"}, 
            React.createElement("button", {className: "btn btn-default dropdown-toggle", type: "button", id: "dropdownMenu1", "data-toggle": "dropdown"}, 
                this.state.selectedCity, 
                React.createElement("span", {className: "caret"})
            ), 
            React.createElement("ul", {className: "dropdown-menu"}, 
                this.cityList
            )
        )
    );
  }
});

var ProviderChkBox = React.createClass({displayName: "ProviderChkBox",
	getInitialState: function(){
		return {
			checked: false
		};
	},
	checkBoxSelection: function(e){
		this.props.updateFilter(e);
		this.setState({checked: !this.state.checked});
	},
	componentWillReceiveProps: function(){
		//use this for setting data before render is called after initial mouning
		this.setState({
			checked: false
		});
	},
	render: function(){
		return (
			React.createElement("input", {type: "checkbox", checked: this.state.checked ? 'checked': null, onChange: this.checkBoxSelection, value: this.props.value})
		)
	}
});

var FilterPanel = React.createClass({displayName: "FilterPanel",
	getInitialState: function(){
		this.filterSelectedProvider = [];
		this.flightProviderArr = [];

		return null;
	},
	handleFilterPanelSelection: function(e){
		if(e.target.checked){
			this.filterSelectedProvider.push(e.target.value);
		}else{
			this.filterSelectedProvider.splice(this.filterSelectedProvider.indexOf(e.target.value), 1);

			if(!this.filterSelectedProvider.length){
				this.filterSelectedProvider = this.flightProviderArr;

				this.props.filterHandler({
					provider: this.filterSelectedProvider
				});

				this.filterSelectedProvider = []

				return false;
			}
		};

		this.props.filterHandler({
			provider: this.filterSelectedProvider
		});

		console.log(this.filterSelectedProvider);
	},
	render: function(){
		this.flightProviderArr = [];
		var providerChkGroup = [];
		this.filterSelectedProvider = [];

		for (var i = this.props.flightProviders.length - 1; i >= 0; i--) {
			if(this.flightProviderArr.indexOf(this.props.flightProviders[i]) === -1){
				this.flightProviderArr.push(this.props.flightProviders[i]);
			}
		};

		for (var i = this.flightProviderArr.length - 1; i >= 0; i--) {
			providerChkGroup.push(
				React.createElement("div", {key: i, className: "checkbox filter-checkbox"}, 
	  				React.createElement("label", null, 
	    				React.createElement(ProviderChkBox, {key: i, value: this.flightProviderArr[i], updateFilter: this.handleFilterPanelSelection}), 
	    					this.flightProviderArr[i]
	  					)
				)
			);
		};

		return (
			React.createElement("div", {className: "col-md-12"}, 
				React.createElement("button", {className: "btn btn-sm btn-default filter-panel-btn", type: "button", "data-toggle": "collapse", "data-target": "#filterFlight"}, 
  					"Filter flights"
				), 
				React.createElement("div", {className: "collapse", id: "filterFlight"}, 
					React.createElement("div", {className: "well"}, 
				    	providerChkGroup
    				)
				)
				
			)
		)
	}
})


var FlightTable = React.createClass({displayName: "FlightTable",
	getInitialState: function(){
		return {
			refreshTable: false
		};
	},
	updateTable: function(data){
		this.updatedData = data;
	},
	render: function(){
		var rows = [];

		if(this.updatedData){
			this.data = this.updatedData;
		}else{
			this.data = this.props.data;
		}

		for(var i = 0;  i < this.data.length; i++ ){
  			rows.push(
  				React.createElement("tr", {key: i}, 
	  				React.createElement("td", null, this.data[i].originCity + "-" + this.data[i].departureCity), 
					React.createElement("td", null, this.data[i].provider + " " + this.data[i].flightNumber), 
					React.createElement("td", null, this.data[i].duration + " hr"), 
					React.createElement("td", null, this.data[i].originTime), 
					React.createElement("td", null, "Rs. " + this.data[i].ticketPrice)
				)
  			);
	  	}

	  	this.updatedData = null;

		return (
			React.createElement("table", {className: "table table-hover"}, 
				React.createElement("thead", null, 
					React.createElement("tr", null, 
				 		React.createElement("th", null, "From - To"), 
				 		React.createElement("th", null, "Flight Name"), 
				 		React.createElement("th", null, "Duration (hrs)"), 
				 		React.createElement("th", null, "Origin Time"), 
				 		React.createElement("th", null, "Price")

					)
				), 
				React.createElement("tbody", null, 
						rows
				)
			)
		)
	}
})

var FlightData = React.createClass({displayName: "FlightData",
	getInitialState: function(){
		this.data = {};

		return {
			isData: false
		}
	},
  	updateData: function(data){
  		this.data = data;
  	},
  	filterTable: function(options){
  		console.log(options);

  		var newData = this.data.filter(function(i){
			return options.provider.indexOf(i.provider) !== -1;
		})
  		this.refs.table.updateTable(newData);
  		this.refs.table.setState({
  			refreshTable: true
  		});
  	},

	render: function(){
		var flightProviders = [];
		var panel;

		for(var i = 0;  i < this.data.length; i++ ){
			flightProviders.push(this.data[i].provider);
	  	}

		if(this.state.isData){
			
			panel = (
					React.createElement("div", {className: "col-md-12"}, 
						React.createElement("div", {className: "page-header"}, 
							React.createElement("h3", null, "Flights available")
						), 
							React.createElement(FilterPanel, {ref: "panel", flightProviders: flightProviders, filterHandler: this.filterTable}), 
						React.createElement("div", {className: "col-md-12"}, 
							React.createElement(FlightTable, {ref: "table", data: this.data})
						)
					)
			)
		}

		return ( 
			React.createElement("div", null, 
				panel
			)
		)
	}
})


var BookingWindow = React.createClass({displayName: "BookingWindow",
	getInitialState: function(){
		this.originCityOption = {
			fetchUrl: "/getCityList",
			defaultText: "choose origin"
		};

		this.destinationCityOption = {
			fetchUrl: "/getCityList",
			defaultText: "choose destination"
		};

		return null;
	},

	fetchFlight: function(){
		var self = this;
		$.ajax({
    		url: '/getFlightDetails',
    		data: {
    			originCity: this.refs.originDD.state.selectedCity,
    			departureCity: this.refs.destinationDD.state.selectedCity
    		},
    		success: function(data){
	    		var data = $.parseJSON(data);

	    		if(data){
		    		self.refs.flightData.updateData(data);
		    		self.refs.flightData.setState({
	    				isData: true
		    		});
	    		}
	    	}
	    });
	},
	
	render: function(){
		return (
			React.createElement("span", null, 
				React.createElement("div", {className: "btn-group col-md-8 selection-panel"}, 
					React.createElement(Dropdown, {key: "0", ref: "originDD", data: this.originCityOption}), 
					React.createElement(Dropdown, {key: "1", ref: "destinationDD", data: this.destinationCityOption}), 
					React.createElement("div", {className: "col-md-3"}, 
	            		React.createElement("button", {className: "btn btn-primary", onClick: this.fetchFlight, type: "button"}, "Search")
	            	)
		        ), 
	            React.createElement(FlightData, {ref: "flightData"})
			)
		)
	}
});

ReactDOM.render(
  React.createElement(BookingWindow, null),
  $('#wrapper')[0]
);

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvc2hvYmhpdGdoYWkvRGVza3RvcC9jcm9zc2xpbmsvcmVhY3QtZmxpZ2h0YXBwL3B1YmxpYy9qcy9jb21wb25lbnRzL2FwcC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxtQkFBbUI7QUFDbkIsQ0FBQyxXQUFXLENBQUM7R0FDVixNQUFNLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUNuQixDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2Q7O0FBRUEsQ0FBQyxXQUFXLENBQUM7SUFDVCxHQUFHLENBQUMsSUFBSSxHQUFHLFVBQVUsQ0FBQztRQUNsQixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQztLQUN2QjtBQUNMLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQzs7QUFFUixJQUFJLDhCQUE4Qix3QkFBQTtFQUNoQyxlQUFlLEVBQUUsV0FBVyxDQUFDO0FBQy9CLEdBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7O0lBRWxCLE9BQU87TUFDTCxNQUFNLEdBQUcsRUFBRTtNQUNYLFlBQVksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXO0tBQzFDLENBQUM7QUFDTixHQUFHOztFQUVELGlCQUFpQixFQUFFLFdBQVcsQ0FBQztHQUM5QixJQUFJLElBQUksR0FBRyxJQUFJLENBQUM7SUFDZixDQUFDLENBQUMsSUFBSSxDQUFDO0tBQ04sR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVE7S0FDN0IsT0FBTyxFQUFFLFNBQVMsSUFBSSxDQUFDLENBQUM7TUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQztPQUNiLE1BQU0sRUFBRSxJQUFJO09BQ1osQ0FBQyxDQUFDO01B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aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyBEZWZpbmUgTmFtZXNwYWNlXG4oZnVuY3Rpb24oKSB7XG4gICB3aW5kb3cuYXBwID0ge307XG59KS5jYWxsKHRoaXMpO1xuXG5cbihmdW5jdGlvbigpIHtcbiAgICBhcHAudXRpbCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiaGVsbG9cIilcbiAgICB9XG59KShhcHApO1xuXG52YXIgRHJvcGRvd24gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gIFx0dGhpcy5jaXR5TGlzdCA9IFtdO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNpdGllcyA6ICcnLFxuICAgICAgc2VsZWN0ZWRDaXR5OiB0aGlzLnByb3BzLmRhdGEuZGVmYXVsdFRleHRcbiAgICB9O1xuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgXHR2YXIgc2VsZiA9IHRoaXM7IFxuICAgICQuYWpheCh7XG4gICAgXHR1cmw6IHNlbGYucHJvcHMuZGF0YS5mZXRjaFVybCxcbiAgICBcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgIFx0XHRzZWxmLnNldFN0YXRlKHtcbiAgICBcdFx0XHRjaXRpZXM6IGRhdGFcbiAgICBcdFx0fSk7XG4gICAgXHR9XG4gICAgfSk7XG4gIH0sXG5cbiAgY2l0eVNlbGVjdGlvbkhhbmRsZXI6IGZ1bmN0aW9uKGUpe1xuICBcdHZhciBzZWxlY3RlZFRleHQgPSAkKGUudGFyZ2V0KS50ZXh0KCk7XG4gIFx0dGhpcy5zZXRTdGF0ZSh7XG4gIFx0XHRzZWxlY3RlZENpdHk6IHNlbGVjdGVkVGV4dFxuICBcdH0pO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gIFx0aWYoIXRoaXMuY2l0eUxpc3QubGVuZ3RoKXtcblx0XHRmb3IodmFyIGkgPSAwOyAgaSA8IHRoaXMuc3RhdGUuY2l0aWVzLmxlbmd0aDsgaSsrICl7XG4gIFx0XHRcdHRoaXMuY2l0eUxpc3QucHVzaCg8bGkga2V5PXtpfSBvbkNsaWNrPXt0aGlzLmNpdHlTZWxlY3Rpb25IYW5kbGVyfT48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+e3RoaXMuc3RhdGUuY2l0aWVzW2ldfTwvYT48L2xpPik7XG5cdCAgXHR9XG4gIFx0fVxuICBcdFxuICAgIHJldHVybiAoXG4gICAgXHQ8ZGl2IGNsYXNzTmFtZT1cImRyb3Bkb3duXCI+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdCBkcm9wZG93bi10b2dnbGVcIiB0eXBlPVwiYnV0dG9uXCIgaWQ9XCJkcm9wZG93bk1lbnUxXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiPlxuICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnNlbGVjdGVkQ2l0eX1cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJjYXJldFwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPHVsIGNsYXNzTmFtZT1cImRyb3Bkb3duLW1lbnVcIj5cbiAgICAgICAgICAgICAgICB7dGhpcy5jaXR5TGlzdH1cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgUHJvdmlkZXJDaGtCb3ggPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4ge1xuXHRcdFx0Y2hlY2tlZDogZmFsc2Vcblx0XHR9O1xuXHR9LFxuXHRjaGVja0JveFNlbGVjdGlvbjogZnVuY3Rpb24oZSl7XG5cdFx0dGhpcy5wcm9wcy51cGRhdGVGaWx0ZXIoZSk7XG5cdFx0dGhpcy5zZXRTdGF0ZSh7Y2hlY2tlZDogIXRoaXMuc3RhdGUuY2hlY2tlZH0pO1xuXHR9LFxuXHRjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbigpe1xuXHRcdC8vdXNlIHRoaXMgZm9yIHNldHRpbmcgZGF0YSBiZWZvcmUgcmVuZGVyIGlzIGNhbGxlZCBhZnRlciBpbml0aWFsIG1vdW5pbmdcblx0XHR0aGlzLnNldFN0YXRlKHtcblx0XHRcdGNoZWNrZWQ6IGZhbHNlXG5cdFx0fSk7XG5cdH0sXG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gKFxuXHRcdFx0PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNoZWNrZWQ9e3RoaXMuc3RhdGUuY2hlY2tlZCA/ICdjaGVja2VkJzogbnVsbH0gb25DaGFuZ2U9e3RoaXMuY2hlY2tCb3hTZWxlY3Rpb259IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfS8+XG5cdFx0KVxuXHR9XG59KTtcblxudmFyIEZpbHRlclBhbmVsID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHRnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5maWx0ZXJTZWxlY3RlZFByb3ZpZGVyID0gW107XG5cdFx0dGhpcy5mbGlnaHRQcm92aWRlckFyciA9IFtdO1xuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdGhhbmRsZUZpbHRlclBhbmVsU2VsZWN0aW9uOiBmdW5jdGlvbihlKXtcblx0XHRpZihlLnRhcmdldC5jaGVja2VkKXtcblx0XHRcdHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlci5wdXNoKGUudGFyZ2V0LnZhbHVlKTtcblx0XHR9ZWxzZXtcblx0XHRcdHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlci5zcGxpY2UodGhpcy5maWx0ZXJTZWxlY3RlZFByb3ZpZGVyLmluZGV4T2YoZS50YXJnZXQudmFsdWUpLCAxKTtcblxuXHRcdFx0aWYoIXRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlci5sZW5ndGgpe1xuXHRcdFx0XHR0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXIgPSB0aGlzLmZsaWdodFByb3ZpZGVyQXJyO1xuXG5cdFx0XHRcdHRoaXMucHJvcHMuZmlsdGVySGFuZGxlcih7XG5cdFx0XHRcdFx0cHJvdmlkZXI6IHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlclxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXIgPSBbXVxuXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dGhpcy5wcm9wcy5maWx0ZXJIYW5kbGVyKHtcblx0XHRcdHByb3ZpZGVyOiB0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXJcblx0XHR9KTtcblxuXHRcdGNvbnNvbGUubG9nKHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlcik7XG5cdH0sXG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcblx0XHR0aGlzLmZsaWdodFByb3ZpZGVyQXJyID0gW107XG5cdFx0dmFyIHByb3ZpZGVyQ2hrR3JvdXAgPSBbXTtcblx0XHR0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXIgPSBbXTtcblxuXHRcdGZvciAodmFyIGkgPSB0aGlzLnByb3BzLmZsaWdodFByb3ZpZGVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0aWYodGhpcy5mbGlnaHRQcm92aWRlckFyci5pbmRleE9mKHRoaXMucHJvcHMuZmxpZ2h0UHJvdmlkZXJzW2ldKSA9PT0gLTEpe1xuXHRcdFx0XHR0aGlzLmZsaWdodFByb3ZpZGVyQXJyLnB1c2godGhpcy5wcm9wcy5mbGlnaHRQcm92aWRlcnNbaV0pO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRmb3IgKHZhciBpID0gdGhpcy5mbGlnaHRQcm92aWRlckFyci5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0cHJvdmlkZXJDaGtHcm91cC5wdXNoKFxuXHRcdFx0XHQ8ZGl2IGtleT17aX0gY2xhc3NOYW1lPVwiY2hlY2tib3ggZmlsdGVyLWNoZWNrYm94XCI+XG5cdCAgXHRcdFx0XHQ8bGFiZWw+XG5cdCAgICBcdFx0XHRcdDxQcm92aWRlckNoa0JveCBrZXk9e2l9IHZhbHVlPXt0aGlzLmZsaWdodFByb3ZpZGVyQXJyW2ldfSB1cGRhdGVGaWx0ZXI9e3RoaXMuaGFuZGxlRmlsdGVyUGFuZWxTZWxlY3Rpb259Lz5cblx0ICAgIFx0XHRcdFx0XHR7dGhpcy5mbGlnaHRQcm92aWRlckFycltpXX1cblx0ICBcdFx0XHRcdFx0PC9sYWJlbD5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHQpO1xuXHRcdH07XG5cblx0XHRyZXR1cm4gKFxuXHRcdFx0PGRpdiBjbGFzc05hbWU9XCJjb2wtbWQtMTJcIj4gXG5cdFx0XHRcdDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi1zbSBidG4tZGVmYXVsdCBmaWx0ZXItcGFuZWwtYnRuXCIgdHlwZT1cImJ1dHRvblwiIGRhdGEtdG9nZ2xlPVwiY29sbGFwc2VcIiBkYXRhLXRhcmdldD1cIiNmaWx0ZXJGbGlnaHRcIj5cbiAgXHRcdFx0XHRcdEZpbHRlciBmbGlnaHRzXG5cdFx0XHRcdDwvYnV0dG9uPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cImNvbGxhcHNlXCIgaWQ9XCJmaWx0ZXJGbGlnaHRcIj5cblx0XHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cIndlbGxcIj5cblx0XHRcdFx0ICAgIFx0e3Byb3ZpZGVyQ2hrR3JvdXB9XG4gICAgXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFxuXHRcdFx0PC9kaXY+XG5cdFx0KVxuXHR9XG59KVxuXG5cbnZhciBGbGlnaHRUYWJsZSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0Z2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpe1xuXHRcdHJldHVybiB7XG5cdFx0XHRyZWZyZXNoVGFibGU6IGZhbHNlXG5cdFx0fTtcblx0fSxcblx0dXBkYXRlVGFibGU6IGZ1bmN0aW9uKGRhdGEpe1xuXHRcdHRoaXMudXBkYXRlZERhdGEgPSBkYXRhO1xuXHR9LFxuXHRyZW5kZXI6IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIHJvd3MgPSBbXTtcblxuXHRcdGlmKHRoaXMudXBkYXRlZERhdGEpe1xuXHRcdFx0dGhpcy5kYXRhID0gdGhpcy51cGRhdGVkRGF0YTtcblx0XHR9ZWxzZXtcblx0XHRcdHRoaXMuZGF0YSA9IHRoaXMucHJvcHMuZGF0YTtcblx0XHR9XG5cblx0XHRmb3IodmFyIGkgPSAwOyAgaSA8IHRoaXMuZGF0YS5sZW5ndGg7IGkrKyApe1xuICBcdFx0XHRyb3dzLnB1c2goXG4gIFx0XHRcdFx0PHRyIGtleT17aX0+XG5cdCAgXHRcdFx0XHQ8dGQ+e3RoaXMuZGF0YVtpXS5vcmlnaW5DaXR5ICsgXCItXCIgKyB0aGlzLmRhdGFbaV0uZGVwYXJ0dXJlQ2l0eX08L3RkPlxuXHRcdFx0XHRcdDx0ZD57dGhpcy5kYXRhW2ldLnByb3ZpZGVyICsgXCIgXCIgKyB0aGlzLmRhdGFbaV0uZmxpZ2h0TnVtYmVyfTwvdGQ+XG5cdFx0XHRcdFx0PHRkPnt0aGlzLmRhdGFbaV0uZHVyYXRpb24gKyBcIiBoclwifTwvdGQ+XG5cdFx0XHRcdFx0PHRkPnt0aGlzLmRhdGFbaV0ub3JpZ2luVGltZX08L3RkPlxuXHRcdFx0XHRcdDx0ZD57XCJScy4gXCIgKyB0aGlzLmRhdGFbaV0udGlja2V0UHJpY2V9PC90ZD5cblx0XHRcdFx0PC90cj5cbiAgXHRcdFx0KTtcblx0ICBcdH1cblxuXHQgIFx0dGhpcy51cGRhdGVkRGF0YSA9IG51bGw7XG5cblx0XHRyZXR1cm4gKFxuXHRcdFx0PHRhYmxlIGNsYXNzTmFtZT1cInRhYmxlIHRhYmxlLWhvdmVyXCI+XG5cdFx0XHRcdDx0aGVhZD5cblx0XHRcdFx0XHQ8dHI+XG5cdFx0XHRcdCBcdFx0PHRoPkZyb20gLSBUbzwvdGg+XG5cdFx0XHRcdCBcdFx0PHRoPkZsaWdodCBOYW1lPC90aD5cblx0XHRcdFx0IFx0XHQ8dGg+RHVyYXRpb24gKGhycyk8L3RoPlxuXHRcdFx0XHQgXHRcdDx0aD5PcmlnaW4gVGltZTwvdGg+XG5cdFx0XHRcdCBcdFx0PHRoPlByaWNlPC90aD5cblxuXHRcdFx0XHRcdDwvdHI+XG5cdFx0XHRcdDwvdGhlYWQ+XG5cdFx0XHRcdDx0Ym9keT5cblx0XHRcdFx0XHRcdHtyb3dzfVxuXHRcdFx0XHQ8L3Rib2R5PlxuXHRcdFx0PC90YWJsZT5cblx0XHQpXG5cdH1cbn0pXG5cbnZhciBGbGlnaHREYXRhID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHRnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5kYXRhID0ge307XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0aXNEYXRhOiBmYWxzZVxuXHRcdH1cblx0fSxcbiAgXHR1cGRhdGVEYXRhOiBmdW5jdGlvbihkYXRhKXtcbiAgXHRcdHRoaXMuZGF0YSA9IGRhdGE7XG4gIFx0fSxcbiAgXHRmaWx0ZXJUYWJsZTogZnVuY3Rpb24ob3B0aW9ucyl7XG4gIFx0XHRjb25zb2xlLmxvZyhvcHRpb25zKTtcblxuICBcdFx0dmFyIG5ld0RhdGEgPSB0aGlzLmRhdGEuZmlsdGVyKGZ1bmN0aW9uKGkpe1xuXHRcdFx0cmV0dXJuIG9wdGlvbnMucHJvdmlkZXIuaW5kZXhPZihpLnByb3ZpZGVyKSAhPT0gLTE7XG5cdFx0fSlcbiAgXHRcdHRoaXMucmVmcy50YWJsZS51cGRhdGVUYWJsZShuZXdEYXRhKTtcbiAgXHRcdHRoaXMucmVmcy50YWJsZS5zZXRTdGF0ZSh7XG4gIFx0XHRcdHJlZnJlc2hUYWJsZTogdHJ1ZVxuICBcdFx0fSk7XG4gIFx0fSxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIGZsaWdodFByb3ZpZGVycyA9IFtdO1xuXHRcdHZhciBwYW5lbDtcblxuXHRcdGZvcih2YXIgaSA9IDA7ICBpIDwgdGhpcy5kYXRhLmxlbmd0aDsgaSsrICl7XG5cdFx0XHRmbGlnaHRQcm92aWRlcnMucHVzaCh0aGlzLmRhdGFbaV0ucHJvdmlkZXIpO1xuXHQgIFx0fVxuXG5cdFx0aWYodGhpcy5zdGF0ZS5pc0RhdGEpe1xuXHRcdFx0XG5cdFx0XHRwYW5lbCA9IChcblx0XHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cImNvbC1tZC0xMlwiPlxuXHRcdFx0XHRcdFx0PGRpdiBjbGFzc05hbWU9XCJwYWdlLWhlYWRlclwiPlxuXHRcdFx0XHRcdFx0XHQ8aDM+RmxpZ2h0cyBhdmFpbGFibGU8L2gzPlxuXHRcdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHRcdFx0XHRcdDxGaWx0ZXJQYW5lbCByZWY9XCJwYW5lbFwiIGZsaWdodFByb3ZpZGVycz17ZmxpZ2h0UHJvdmlkZXJzfSBmaWx0ZXJIYW5kbGVyPXt0aGlzLmZpbHRlclRhYmxlfS8+XG5cdFx0XHRcdFx0XHQ8ZGl2IGNsYXNzTmFtZT1cImNvbC1tZC0xMlwiPlxuXHRcdFx0XHRcdFx0XHQ8RmxpZ2h0VGFibGUgcmVmPVwidGFibGVcIiBkYXRhPXt0aGlzLmRhdGF9IC8+XG5cdFx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdFx0XHQ8L2Rpdj5cblx0XHRcdClcblx0XHR9XG5cblx0XHRyZXR1cm4gKCBcblx0XHRcdDxkaXY+XG5cdFx0XHRcdHtwYW5lbH1cblx0XHRcdDwvZGl2PlxuXHRcdClcblx0fVxufSlcblxuXG52YXIgQm9va2luZ1dpbmRvdyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0Z2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMub3JpZ2luQ2l0eU9wdGlvbiA9IHtcblx0XHRcdGZldGNoVXJsOiBcIi9nZXRDaXR5TGlzdFwiLFxuXHRcdFx0ZGVmYXVsdFRleHQ6IFwiY2hvb3NlIG9yaWdpblwiXG5cdFx0fTtcblxuXHRcdHRoaXMuZGVzdGluYXRpb25DaXR5T3B0aW9uID0ge1xuXHRcdFx0ZmV0Y2hVcmw6IFwiL2dldENpdHlMaXN0XCIsXG5cdFx0XHRkZWZhdWx0VGV4dDogXCJjaG9vc2UgZGVzdGluYXRpb25cIlxuXHRcdH07XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblxuXHRmZXRjaEZsaWdodDogZnVuY3Rpb24oKXtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0JC5hamF4KHtcbiAgICBcdFx0dXJsOiAnL2dldEZsaWdodERldGFpbHMnLFxuICAgIFx0XHRkYXRhOiB7XG4gICAgXHRcdFx0b3JpZ2luQ2l0eTogdGhpcy5yZWZzLm9yaWdpbkRELnN0YXRlLnNlbGVjdGVkQ2l0eSxcbiAgICBcdFx0XHRkZXBhcnR1cmVDaXR5OiB0aGlzLnJlZnMuZGVzdGluYXRpb25ERC5zdGF0ZS5zZWxlY3RlZENpdHlcbiAgICBcdFx0fSxcbiAgICBcdFx0c3VjY2VzczogZnVuY3Rpb24oZGF0YSl7XG5cdCAgICBcdFx0dmFyIGRhdGEgPSAkLnBhcnNlSlNPTihkYXRhKTtcblxuXHQgICAgXHRcdGlmKGRhdGEpe1xuXHRcdCAgICBcdFx0c2VsZi5yZWZzLmZsaWdodERhdGEudXBkYXRlRGF0YShkYXRhKTtcblx0XHQgICAgXHRcdHNlbGYucmVmcy5mbGlnaHREYXRhLnNldFN0YXRlKHtcblx0ICAgIFx0XHRcdFx0aXNEYXRhOiB0cnVlXG5cdFx0ICAgIFx0XHR9KTtcblx0ICAgIFx0XHR9XG5cdCAgICBcdH1cblx0ICAgIH0pO1xuXHR9LFxuXHRcblx0cmVuZGVyOiBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAoXG5cdFx0XHQ8c3Bhbj5cblx0XHRcdFx0PGRpdiBjbGFzc05hbWU9XCJidG4tZ3JvdXAgY29sLW1kLTggc2VsZWN0aW9uLXBhbmVsXCI+XG5cdFx0XHRcdFx0PERyb3Bkb3duIGtleT1cIjBcIiByZWY9XCJvcmlnaW5ERFwiIGRhdGE9e3RoaXMub3JpZ2luQ2l0eU9wdGlvbn0vPlxuXHRcdFx0XHRcdDxEcm9wZG93biBrZXk9XCIxXCIgcmVmPVwiZGVzdGluYXRpb25ERFwiIGRhdGE9e3RoaXMuZGVzdGluYXRpb25DaXR5T3B0aW9ufS8+XG5cdFx0XHRcdFx0PGRpdiBjbGFzc05hbWU9XCJjb2wtbWQtM1wiPiBcblx0ICAgICAgICAgICAgXHRcdDxidXR0b24gY2xhc3NOYW1lPVwiYnRuIGJ0bi1wcmltYXJ5XCIgb25DbGljaz17dGhpcy5mZXRjaEZsaWdodH0gdHlwZT1cImJ1dHRvblwiPlNlYXJjaDwvYnV0dG9uPlxuXHQgICAgICAgICAgICBcdDwvZGl2PlxuXHRcdCAgICAgICAgPC9kaXY+XG5cdCAgICAgICAgICAgIDxGbGlnaHREYXRhIHJlZj1cImZsaWdodERhdGFcIi8+XG5cdFx0XHQ8L3NwYW4+XG5cdFx0KVxuXHR9XG59KTtcblxuUmVhY3RET00ucmVuZGVyKFxuICA8Qm9va2luZ1dpbmRvdy8+LFxuICAkKCcjd3JhcHBlcicpWzBdXG4pOyJdfQ==
