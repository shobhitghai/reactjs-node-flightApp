(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Define Namespace
(function() {
   window.app = {};
}).call(this);


(function() {
    app.util = function(){
        console.log("hello")
    }
})(app);

var Dropdown = React.createClass({displayName: "Dropdown",
  getInitialState: function() {
  	this.cityList = [];

    return {
      cities : '',
      selectedCity: this.props.data.defaultText
    };
  },

  componentDidMount: function() {
  	var self = this; 
    $.ajax({
    	url: self.props.data.fetchUrl,
    	success: function(data){
    		self.setState({
    			cities: data
    		});
    	}
    });
  },

  citySelectionHandler: function(e){
  	var selectedText = $(e.target).text();
  	this.setState({
  		selectedCity: selectedText
  	});
  },

  render: function() {
  	if(!this.cityList.length){
		for(var i = 0;  i < this.state.cities.length; i++ ){
  			this.cityList.push(React.createElement("li", {key: i, onClick: this.citySelectionHandler}, React.createElement("a", {href: "javascript:void(0)"}, this.state.cities[i])));
	  	}
  	}
  	
    return (
    	React.createElement("div", {className: "dropdown"}, 
            React.createElement("button", {className: "btn btn-default dropdown-toggle", type: "button", id: "dropdownMenu1", "data-toggle": "dropdown"}, 
                this.state.selectedCity, 
                React.createElement("span", {className: "caret"})
            ), 
            React.createElement("ul", {className: "dropdown-menu"}, 
                this.cityList
            )
        )
    );
  }
});

var ProviderChkBox = React.createClass({displayName: "ProviderChkBox",
	getInitialState: function(){
		return {
			checked: false
		};
	},
	checkBoxSelection: function(e){
		this.props.updateFilter(e);
		this.setState({checked: !this.state.checked});
	},
	componentWillReceiveProps: function(){
		//use this for setting data before render is called after initial mouning
		this.setState({
			checked: false
		});
	},
	render: function(){
		return (
			React.createElement("input", {type: "checkbox", checked: this.state.checked ? 'checked': null, onChange: this.checkBoxSelection, value: this.props.value})
		)
	}
});

var FilterPanel = React.createClass({displayName: "FilterPanel",
	getInitialState: function(){
		this.filterSelectedProvider = [];
		this.flightProviderArr = [];

		return null;
	},
	handleFilterPanelSelection: function(e){
		if(e.target.checked){
			this.filterSelectedProvider.push(e.target.value);
		}else{
			this.filterSelectedProvider.splice(this.filterSelectedProvider.indexOf(e.target.value), 1);

			if(!this.filterSelectedProvider.length){
				this.filterSelectedProvider = this.flightProviderArr;

				this.props.filterHandler({
					provider: this.filterSelectedProvider
				});

				this.filterSelectedProvider = []

				return false;
			}
		};

		this.props.filterHandler({
			provider: this.filterSelectedProvider
		});

		console.log(this.filterSelectedProvider);
	},
	render: function(){
		this.flightProviderArr = [];
		var providerChkGroup = [];
		this.filterSelectedProvider = [];

		for (var i = this.props.flightProviders.length - 1; i >= 0; i--) {
			if(this.flightProviderArr.indexOf(this.props.flightProviders[i]) === -1){
				this.flightProviderArr.push(this.props.flightProviders[i]);
			}
		};

		for (var i = this.flightProviderArr.length - 1; i >= 0; i--) {
			providerChkGroup.push(
				React.createElement("div", {key: i, className: "checkbox"}, 
	  				React.createElement("label", null, 
	    				React.createElement(ProviderChkBox, {key: i, value: this.flightProviderArr[i], updateFilter: this.handleFilterPanelSelection}), 
	    					this.flightProviderArr[i]
	  					)
				)
			);
		};

		return (
			React.createElement("div", null, 
				providerChkGroup
			)
		)
	}
})


var FlightTable = React.createClass({displayName: "FlightTable",
	getInitialState: function(){
		return {
			refreshTable: false
		};
	},
	updateTable: function(data){
		this.updatedData = data;
	},
	render: function(){
		var rows = [];

		if(this.updatedData){
			this.data = this.updatedData;
		}else{
			this.data = this.props.data;
		}

		for(var i = 0;  i < this.data.length; i++ ){
  			rows.push(
  				React.createElement("tr", {key: i}, 
	  				React.createElement("td", null, this.data[i].originCity + "-" + this.data[i].departureCity), 
					React.createElement("td", null, this.data[i].provider + " " + this.data[i].flightNumber), 
					React.createElement("td", null, this.data[i].duration + " hr"), 
					React.createElement("td", null, this.data[i].originTime), 
					React.createElement("td", null, "Rs. " + this.data[i].ticketPrice)
				)
  			);
	  	}

	  	this.updatedData = null;

		return (
			React.createElement("table", {className: "table table-hover"}, 
				React.createElement("thead", null, 
					React.createElement("tr", null, 
				 		React.createElement("th", null, "From - To"), 
				 		React.createElement("th", null, "Flight Name"), 
				 		React.createElement("th", null, "Duration (hrs)"), 
				 		React.createElement("th", null, "Origin Time"), 
				 		React.createElement("th", null, "Price")

					)
				), 
				React.createElement("tbody", null, 
						rows
				)
			)
		)
	}
})

var FlightData = React.createClass({displayName: "FlightData",
	getInitialState: function(){
		this.data = {};

		return {
			isData: false
		}
	},
  	updateData: function(data){
  		this.data = data;
  	},
  	filterTable: function(options){
  		console.log(options);

  		var newData = this.data.filter(function(i){
			return options.provider.indexOf(i.provider) !== -1;
		})
  		this.refs.table.updateTable(newData);
  		this.refs.table.setState({
  			refreshTable: true
  		});
  	},

	render: function(){
		var flightProviders = [];
		var panel;

		for(var i = 0;  i < this.data.length; i++ ){
			flightProviders.push(this.data[i].provider);
	  	}

		if(this.state.isData){
			
			panel = (
					React.createElement("div", null, 
						React.createElement(FilterPanel, {ref: "panel", flightProviders: flightProviders, filterHandler: this.filterTable}), 
						React.createElement(FlightTable, {ref: "table", data: this.data})
					)
			)
		}

		return ( 
			React.createElement("div", null, 
				panel
			)
		)
	}
})


var BookingWindow = React.createClass({displayName: "BookingWindow",
	getInitialState: function(){
		this.originCityOption = {
			fetchUrl: "/getCityList",
			defaultText: "choose origin"
		};

		this.destinationCityOption = {
			fetchUrl: "/getCityList",
			defaultText: "choose destination"
		};

		return null;
	},

	fetchFlight: function(){
		var self = this;
		$.ajax({
    		url: '/getFlightDetails',
    		data: {
    			originCity: this.refs.originDD.state.selectedCity,
    			departureCity: this.refs.destinationDD.state.selectedCity
    		},
    		success: function(data){
	    		var data = $.parseJSON(data);

	    		if(data){
		    		self.refs.flightData.updateData(data);
		    		self.refs.flightData.setState({
	    				isData: true
		    		});
	    		}
	    	}
	    });
	},
	
	render: function(){
		return (
			React.createElement("span", null, 
				React.createElement(Dropdown, {key: "0", ref: "originDD", data: this.originCityOption}), 
				React.createElement(Dropdown, {key: "1", ref: "destinationDD", data: this.destinationCityOption}), 
	            React.createElement("button", {className: "btn btn-primary", onClick: this.fetchFlight, type: "button"}, "Submit"), 
	            React.createElement(FlightData, {ref: "flightData"})
			)
		)
	}
});

ReactDOM.render(
  React.createElement(BookingWindow, null),
  $('#wrapper')[0]
);

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvc2hvYmhpdGdoYWkvRGVza3RvcC9jcm9zc2xpbmsvcmVhY3QtZmxpZ2h0YXBwL3B1YmxpYy9qcy9jb21wb25lbnRzL2FwcC5qc3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQSxtQkFBbUI7QUFDbkIsQ0FBQyxXQUFXLENBQUM7R0FDVixNQUFNLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQztBQUNuQixDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2Q7O0FBRUEsQ0FBQyxXQUFXLENBQUM7SUFDVCxHQUFHLENBQUMsSUFBSSxHQUFHLFVBQVUsQ0FBQztRQUNsQixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQztLQUN2QjtBQUNMLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQzs7QUFFUixJQUFJLDhCQUE4Qix3QkFBQTtFQUNoQyxlQUFlLEVBQUUsV0FBVyxDQUFDO0FBQy9CLEdBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7O0lBRWxCLE9BQU87TUFDTCxNQUFNLEdBQUcsRUFBRTtNQUNYLFlBQVksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxXQUFXO0tBQzFDLENBQUM7QUFDTixHQUFHOztFQUVELGlCQUFpQixFQUFFLFdBQVcsQ0FBQztHQUM5QixJQUFJLElBQUksR0FBRyxJQUFJLENBQUM7SUFDZixDQUFDLENBQUMsSUFBSSxDQUFDO0tBQ04sR0FBRyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVE7S0FDN0IsT0FBTyxFQUFFLFNBQVMsSUFBSSxDQUFDLENBQUM7TUFDdkIsSUFBSSxDQUFDLFFBQVEsQ0FBQztPQUNiLE1BQU0sRUFBRSxJQUFJO09BQ1osQ0FBQyxDQUFDO01B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RUFBQSxJQUFFLENBQUE7RUFDaEIsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztDQUNqQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyBEZWZpbmUgTmFtZXNwYWNlXG4oZnVuY3Rpb24oKSB7XG4gICB3aW5kb3cuYXBwID0ge307XG59KS5jYWxsKHRoaXMpO1xuXG5cbihmdW5jdGlvbigpIHtcbiAgICBhcHAudXRpbCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiaGVsbG9cIilcbiAgICB9XG59KShhcHApO1xuXG52YXIgRHJvcGRvd24gPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG4gIGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKSB7XG4gIFx0dGhpcy5jaXR5TGlzdCA9IFtdO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIGNpdGllcyA6ICcnLFxuICAgICAgc2VsZWN0ZWRDaXR5OiB0aGlzLnByb3BzLmRhdGEuZGVmYXVsdFRleHRcbiAgICB9O1xuICB9LFxuXG4gIGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpIHtcbiAgXHR2YXIgc2VsZiA9IHRoaXM7IFxuICAgICQuYWpheCh7XG4gICAgXHR1cmw6IHNlbGYucHJvcHMuZGF0YS5mZXRjaFVybCxcbiAgICBcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuICAgIFx0XHRzZWxmLnNldFN0YXRlKHtcbiAgICBcdFx0XHRjaXRpZXM6IGRhdGFcbiAgICBcdFx0fSk7XG4gICAgXHR9XG4gICAgfSk7XG4gIH0sXG5cbiAgY2l0eVNlbGVjdGlvbkhhbmRsZXI6IGZ1bmN0aW9uKGUpe1xuICBcdHZhciBzZWxlY3RlZFRleHQgPSAkKGUudGFyZ2V0KS50ZXh0KCk7XG4gIFx0dGhpcy5zZXRTdGF0ZSh7XG4gIFx0XHRzZWxlY3RlZENpdHk6IHNlbGVjdGVkVGV4dFxuICBcdH0pO1xuICB9LFxuXG4gIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gIFx0aWYoIXRoaXMuY2l0eUxpc3QubGVuZ3RoKXtcblx0XHRmb3IodmFyIGkgPSAwOyAgaSA8IHRoaXMuc3RhdGUuY2l0aWVzLmxlbmd0aDsgaSsrICl7XG4gIFx0XHRcdHRoaXMuY2l0eUxpc3QucHVzaCg8bGkga2V5PXtpfSBvbkNsaWNrPXt0aGlzLmNpdHlTZWxlY3Rpb25IYW5kbGVyfT48YSBocmVmPVwiamF2YXNjcmlwdDp2b2lkKDApXCI+e3RoaXMuc3RhdGUuY2l0aWVzW2ldfTwvYT48L2xpPik7XG5cdCAgXHR9XG4gIFx0fVxuICBcdFxuICAgIHJldHVybiAoXG4gICAgXHQ8ZGl2IGNsYXNzTmFtZT1cImRyb3Bkb3duXCI+XG4gICAgICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImJ0biBidG4tZGVmYXVsdCBkcm9wZG93bi10b2dnbGVcIiB0eXBlPVwiYnV0dG9uXCIgaWQ9XCJkcm9wZG93bk1lbnUxXCIgZGF0YS10b2dnbGU9XCJkcm9wZG93blwiPlxuICAgICAgICAgICAgICAgIHt0aGlzLnN0YXRlLnNlbGVjdGVkQ2l0eX1cbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJjYXJldFwiPjwvc3Bhbj5cbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAgPHVsIGNsYXNzTmFtZT1cImRyb3Bkb3duLW1lbnVcIj5cbiAgICAgICAgICAgICAgICB7dGhpcy5jaXR5TGlzdH1cbiAgICAgICAgICAgIDwvdWw+XG4gICAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn0pO1xuXG52YXIgUHJvdmlkZXJDaGtCb3ggPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4ge1xuXHRcdFx0Y2hlY2tlZDogZmFsc2Vcblx0XHR9O1xuXHR9LFxuXHRjaGVja0JveFNlbGVjdGlvbjogZnVuY3Rpb24oZSl7XG5cdFx0dGhpcy5wcm9wcy51cGRhdGVGaWx0ZXIoZSk7XG5cdFx0dGhpcy5zZXRTdGF0ZSh7Y2hlY2tlZDogIXRoaXMuc3RhdGUuY2hlY2tlZH0pO1xuXHR9LFxuXHRjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzOiBmdW5jdGlvbigpe1xuXHRcdC8vdXNlIHRoaXMgZm9yIHNldHRpbmcgZGF0YSBiZWZvcmUgcmVuZGVyIGlzIGNhbGxlZCBhZnRlciBpbml0aWFsIG1vdW5pbmdcblx0XHR0aGlzLnNldFN0YXRlKHtcblx0XHRcdGNoZWNrZWQ6IGZhbHNlXG5cdFx0fSk7XG5cdH0sXG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gKFxuXHRcdFx0PGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGNoZWNrZWQ9e3RoaXMuc3RhdGUuY2hlY2tlZCA/ICdjaGVja2VkJzogbnVsbH0gb25DaGFuZ2U9e3RoaXMuY2hlY2tCb3hTZWxlY3Rpb259IHZhbHVlPXt0aGlzLnByb3BzLnZhbHVlfS8+XG5cdFx0KVxuXHR9XG59KTtcblxudmFyIEZpbHRlclBhbmVsID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXHRnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCl7XG5cdFx0dGhpcy5maWx0ZXJTZWxlY3RlZFByb3ZpZGVyID0gW107XG5cdFx0dGhpcy5mbGlnaHRQcm92aWRlckFyciA9IFtdO1xuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cdGhhbmRsZUZpbHRlclBhbmVsU2VsZWN0aW9uOiBmdW5jdGlvbihlKXtcblx0XHRpZihlLnRhcmdldC5jaGVja2VkKXtcblx0XHRcdHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlci5wdXNoKGUudGFyZ2V0LnZhbHVlKTtcblx0XHR9ZWxzZXtcblx0XHRcdHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlci5zcGxpY2UodGhpcy5maWx0ZXJTZWxlY3RlZFByb3ZpZGVyLmluZGV4T2YoZS50YXJnZXQudmFsdWUpLCAxKTtcblxuXHRcdFx0aWYoIXRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlci5sZW5ndGgpe1xuXHRcdFx0XHR0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXIgPSB0aGlzLmZsaWdodFByb3ZpZGVyQXJyO1xuXG5cdFx0XHRcdHRoaXMucHJvcHMuZmlsdGVySGFuZGxlcih7XG5cdFx0XHRcdFx0cHJvdmlkZXI6IHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlclxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHR0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXIgPSBbXVxuXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dGhpcy5wcm9wcy5maWx0ZXJIYW5kbGVyKHtcblx0XHRcdHByb3ZpZGVyOiB0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXJcblx0XHR9KTtcblxuXHRcdGNvbnNvbGUubG9nKHRoaXMuZmlsdGVyU2VsZWN0ZWRQcm92aWRlcik7XG5cdH0sXG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcblx0XHR0aGlzLmZsaWdodFByb3ZpZGVyQXJyID0gW107XG5cdFx0dmFyIHByb3ZpZGVyQ2hrR3JvdXAgPSBbXTtcblx0XHR0aGlzLmZpbHRlclNlbGVjdGVkUHJvdmlkZXIgPSBbXTtcblxuXHRcdGZvciAodmFyIGkgPSB0aGlzLnByb3BzLmZsaWdodFByb3ZpZGVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0aWYodGhpcy5mbGlnaHRQcm92aWRlckFyci5pbmRleE9mKHRoaXMucHJvcHMuZmxpZ2h0UHJvdmlkZXJzW2ldKSA9PT0gLTEpe1xuXHRcdFx0XHR0aGlzLmZsaWdodFByb3ZpZGVyQXJyLnB1c2godGhpcy5wcm9wcy5mbGlnaHRQcm92aWRlcnNbaV0pO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHRmb3IgKHZhciBpID0gdGhpcy5mbGlnaHRQcm92aWRlckFyci5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHRcdFx0cHJvdmlkZXJDaGtHcm91cC5wdXNoKFxuXHRcdFx0XHQ8ZGl2IGtleT17aX0gY2xhc3NOYW1lPVwiY2hlY2tib3hcIj5cblx0ICBcdFx0XHRcdDxsYWJlbD5cblx0ICAgIFx0XHRcdFx0PFByb3ZpZGVyQ2hrQm94IGtleT17aX0gdmFsdWU9e3RoaXMuZmxpZ2h0UHJvdmlkZXJBcnJbaV19IHVwZGF0ZUZpbHRlcj17dGhpcy5oYW5kbGVGaWx0ZXJQYW5lbFNlbGVjdGlvbn0vPlxuXHQgICAgXHRcdFx0XHRcdHt0aGlzLmZsaWdodFByb3ZpZGVyQXJyW2ldfVxuXHQgIFx0XHRcdFx0XHQ8L2xhYmVsPlxuXHRcdFx0XHQ8L2Rpdj5cblx0XHRcdCk7XG5cdFx0fTtcblxuXHRcdHJldHVybiAoXG5cdFx0XHQ8ZGl2PlxuXHRcdFx0XHR7cHJvdmlkZXJDaGtHcm91cH1cblx0XHRcdDwvZGl2PlxuXHRcdClcblx0fVxufSlcblxuXG52YXIgRmxpZ2h0VGFibGUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4ge1xuXHRcdFx0cmVmcmVzaFRhYmxlOiBmYWxzZVxuXHRcdH07XG5cdH0sXG5cdHVwZGF0ZVRhYmxlOiBmdW5jdGlvbihkYXRhKXtcblx0XHR0aGlzLnVwZGF0ZWREYXRhID0gZGF0YTtcblx0fSxcblx0cmVuZGVyOiBmdW5jdGlvbigpe1xuXHRcdHZhciByb3dzID0gW107XG5cblx0XHRpZih0aGlzLnVwZGF0ZWREYXRhKXtcblx0XHRcdHRoaXMuZGF0YSA9IHRoaXMudXBkYXRlZERhdGE7XG5cdFx0fWVsc2V7XG5cdFx0XHR0aGlzLmRhdGEgPSB0aGlzLnByb3BzLmRhdGE7XG5cdFx0fVxuXG5cdFx0Zm9yKHZhciBpID0gMDsgIGkgPCB0aGlzLmRhdGEubGVuZ3RoOyBpKysgKXtcbiAgXHRcdFx0cm93cy5wdXNoKFxuICBcdFx0XHRcdDx0ciBrZXk9e2l9PlxuXHQgIFx0XHRcdFx0PHRkPnt0aGlzLmRhdGFbaV0ub3JpZ2luQ2l0eSArIFwiLVwiICsgdGhpcy5kYXRhW2ldLmRlcGFydHVyZUNpdHl9PC90ZD5cblx0XHRcdFx0XHQ8dGQ+e3RoaXMuZGF0YVtpXS5wcm92aWRlciArIFwiIFwiICsgdGhpcy5kYXRhW2ldLmZsaWdodE51bWJlcn08L3RkPlxuXHRcdFx0XHRcdDx0ZD57dGhpcy5kYXRhW2ldLmR1cmF0aW9uICsgXCIgaHJcIn08L3RkPlxuXHRcdFx0XHRcdDx0ZD57dGhpcy5kYXRhW2ldLm9yaWdpblRpbWV9PC90ZD5cblx0XHRcdFx0XHQ8dGQ+e1wiUnMuIFwiICsgdGhpcy5kYXRhW2ldLnRpY2tldFByaWNlfTwvdGQ+XG5cdFx0XHRcdDwvdHI+XG4gIFx0XHRcdCk7XG5cdCAgXHR9XG5cblx0ICBcdHRoaXMudXBkYXRlZERhdGEgPSBudWxsO1xuXG5cdFx0cmV0dXJuIChcblx0XHRcdDx0YWJsZSBjbGFzc05hbWU9XCJ0YWJsZSB0YWJsZS1ob3ZlclwiPlxuXHRcdFx0XHQ8dGhlYWQ+XG5cdFx0XHRcdFx0PHRyPlxuXHRcdFx0XHQgXHRcdDx0aD5Gcm9tIC0gVG88L3RoPlxuXHRcdFx0XHQgXHRcdDx0aD5GbGlnaHQgTmFtZTwvdGg+XG5cdFx0XHRcdCBcdFx0PHRoPkR1cmF0aW9uIChocnMpPC90aD5cblx0XHRcdFx0IFx0XHQ8dGg+T3JpZ2luIFRpbWU8L3RoPlxuXHRcdFx0XHQgXHRcdDx0aD5QcmljZTwvdGg+XG5cblx0XHRcdFx0XHQ8L3RyPlxuXHRcdFx0XHQ8L3RoZWFkPlxuXHRcdFx0XHQ8dGJvZHk+XG5cdFx0XHRcdFx0XHR7cm93c31cblx0XHRcdFx0PC90Ym9keT5cblx0XHRcdDwvdGFibGU+XG5cdFx0KVxuXHR9XG59KVxuXG52YXIgRmxpZ2h0RGF0YSA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcblx0Z2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpe1xuXHRcdHRoaXMuZGF0YSA9IHt9O1xuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGlzRGF0YTogZmFsc2Vcblx0XHR9XG5cdH0sXG4gIFx0dXBkYXRlRGF0YTogZnVuY3Rpb24oZGF0YSl7XG4gIFx0XHR0aGlzLmRhdGEgPSBkYXRhO1xuICBcdH0sXG4gIFx0ZmlsdGVyVGFibGU6IGZ1bmN0aW9uKG9wdGlvbnMpe1xuICBcdFx0Y29uc29sZS5sb2cob3B0aW9ucyk7XG5cbiAgXHRcdHZhciBuZXdEYXRhID0gdGhpcy5kYXRhLmZpbHRlcihmdW5jdGlvbihpKXtcblx0XHRcdHJldHVybiBvcHRpb25zLnByb3ZpZGVyLmluZGV4T2YoaS5wcm92aWRlcikgIT09IC0xO1xuXHRcdH0pXG4gIFx0XHR0aGlzLnJlZnMudGFibGUudXBkYXRlVGFibGUobmV3RGF0YSk7XG4gIFx0XHR0aGlzLnJlZnMudGFibGUuc2V0U3RhdGUoe1xuICBcdFx0XHRyZWZyZXNoVGFibGU6IHRydWVcbiAgXHRcdH0pO1xuICBcdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpe1xuXHRcdHZhciBmbGlnaHRQcm92aWRlcnMgPSBbXTtcblx0XHR2YXIgcGFuZWw7XG5cblx0XHRmb3IodmFyIGkgPSAwOyAgaSA8IHRoaXMuZGF0YS5sZW5ndGg7IGkrKyApe1xuXHRcdFx0ZmxpZ2h0UHJvdmlkZXJzLnB1c2godGhpcy5kYXRhW2ldLnByb3ZpZGVyKTtcblx0ICBcdH1cblxuXHRcdGlmKHRoaXMuc3RhdGUuaXNEYXRhKXtcblx0XHRcdFxuXHRcdFx0cGFuZWwgPSAoXG5cdFx0XHRcdFx0PGRpdj5cblx0XHRcdFx0XHRcdDxGaWx0ZXJQYW5lbCByZWY9XCJwYW5lbFwiIGZsaWdodFByb3ZpZGVycz17ZmxpZ2h0UHJvdmlkZXJzfSBmaWx0ZXJIYW5kbGVyPXt0aGlzLmZpbHRlclRhYmxlfS8+XG5cdFx0XHRcdFx0XHQ8RmxpZ2h0VGFibGUgcmVmPVwidGFibGVcIiBkYXRhPXt0aGlzLmRhdGF9IC8+XG5cdFx0XHRcdFx0PC9kaXY+XG5cdFx0XHQpXG5cdFx0fVxuXG5cdFx0cmV0dXJuICggXG5cdFx0XHQ8ZGl2PlxuXHRcdFx0XHR7cGFuZWx9XG5cdFx0XHQ8L2Rpdj5cblx0XHQpXG5cdH1cbn0pXG5cblxudmFyIEJvb2tpbmdXaW5kb3cgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdGdldEluaXRpYWxTdGF0ZTogZnVuY3Rpb24oKXtcblx0XHR0aGlzLm9yaWdpbkNpdHlPcHRpb24gPSB7XG5cdFx0XHRmZXRjaFVybDogXCIvZ2V0Q2l0eUxpc3RcIixcblx0XHRcdGRlZmF1bHRUZXh0OiBcImNob29zZSBvcmlnaW5cIlxuXHRcdH07XG5cblx0XHR0aGlzLmRlc3RpbmF0aW9uQ2l0eU9wdGlvbiA9IHtcblx0XHRcdGZldGNoVXJsOiBcIi9nZXRDaXR5TGlzdFwiLFxuXHRcdFx0ZGVmYXVsdFRleHQ6IFwiY2hvb3NlIGRlc3RpbmF0aW9uXCJcblx0XHR9O1xuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cblx0ZmV0Y2hGbGlnaHQ6IGZ1bmN0aW9uKCl7XG5cdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdCQuYWpheCh7XG4gICAgXHRcdHVybDogJy9nZXRGbGlnaHREZXRhaWxzJyxcbiAgICBcdFx0ZGF0YToge1xuICAgIFx0XHRcdG9yaWdpbkNpdHk6IHRoaXMucmVmcy5vcmlnaW5ERC5zdGF0ZS5zZWxlY3RlZENpdHksXG4gICAgXHRcdFx0ZGVwYXJ0dXJlQ2l0eTogdGhpcy5yZWZzLmRlc3RpbmF0aW9uREQuc3RhdGUuc2VsZWN0ZWRDaXR5XG4gICAgXHRcdH0sXG4gICAgXHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpe1xuXHQgICAgXHRcdHZhciBkYXRhID0gJC5wYXJzZUpTT04oZGF0YSk7XG5cblx0ICAgIFx0XHRpZihkYXRhKXtcblx0XHQgICAgXHRcdHNlbGYucmVmcy5mbGlnaHREYXRhLnVwZGF0ZURhdGEoZGF0YSk7XG5cdFx0ICAgIFx0XHRzZWxmLnJlZnMuZmxpZ2h0RGF0YS5zZXRTdGF0ZSh7XG5cdCAgICBcdFx0XHRcdGlzRGF0YTogdHJ1ZVxuXHRcdCAgICBcdFx0fSk7XG5cdCAgICBcdFx0fVxuXHQgICAgXHR9XG5cdCAgICB9KTtcblx0fSxcblx0XG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gKFxuXHRcdFx0PHNwYW4+XG5cdFx0XHRcdDxEcm9wZG93biBrZXk9XCIwXCIgcmVmPVwib3JpZ2luRERcIiBkYXRhPXt0aGlzLm9yaWdpbkNpdHlPcHRpb259Lz5cblx0XHRcdFx0PERyb3Bkb3duIGtleT1cIjFcIiByZWY9XCJkZXN0aW5hdGlvbkREXCIgZGF0YT17dGhpcy5kZXN0aW5hdGlvbkNpdHlPcHRpb259Lz5cblx0ICAgICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJidG4gYnRuLXByaW1hcnlcIiBvbkNsaWNrPXt0aGlzLmZldGNoRmxpZ2h0fSB0eXBlPVwiYnV0dG9uXCI+U3VibWl0PC9idXR0b24+XG5cdCAgICAgICAgICAgIDxGbGlnaHREYXRhIHJlZj1cImZsaWdodERhdGFcIi8+XG5cdFx0XHQ8L3NwYW4+XG5cdFx0KVxuXHR9XG59KTtcblxuUmVhY3RET00ucmVuZGVyKFxuICA8Qm9va2luZ1dpbmRvdy8+LFxuICAkKCcjd3JhcHBlcicpWzBdXG4pOyJdfQ==
